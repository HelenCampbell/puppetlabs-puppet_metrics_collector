<%- | String        $output_dir,
      Array[String] $hosts,
| -%>

<% $hosts.each | $host | { -%>
  echo 'curl -k https://<%= $host %>:8081/metrics/v1/mbeans/org.apache.activemq:type=Broker,brokerName=localhost,destinationType=Queue,destinationName=puppetlabs.puppetdb.commands' --cert /etc/puppetlabs/puppet/ssl/certs/<%= $::clientcert %>.pem --key /etc/puppetlabs/puppet/ssl/private_keys/<%= $::clientcert %>.pem --cacert /etc/puppetlabs/puppet/ssl/certs/ca.pem >> <%= $output_dir %>/<%= $host %>-`date +'%m_%d_%y_%R'`.json
  curl -k https://<%= $host %>:8081/metrics/v1/mbeans/org.apache.activemq:type=Broker,brokerName=localhost,destinationType=Queue,destinationName=puppetlabs.puppetdb.commands --cert /etc/puppetlabs/puppet/ssl/certs/<%= $::clientcert %>.pem --key /etc/puppetlabs/puppet/ssl/private_keys/<%= $::clientcert %>.pem --cacert /etc/puppetlabs/puppet/ssl/certs/ca.pem >> <%= $output_dir %>/<%= $host %>-`date +'%m_%d_%y_%R'`.json

  echo 'curl -k https://<%= $host %>:8081/metrics/v1/mbeans/puppetlabs.puppetdb.storage%3Aname%3Dcatalog-hash-miss-time' --cert /etc/puppetlabs/puppet/ssl/certs/<%= $::clientcert %>.pem --key /etc/puppetlabs/puppet/ssl/private_keys/<%= $::clientcert %>.pem --cacert /etc/puppetlabs/puppet/ssl/certs/ca.pem >> <%= $output_dir %>/catalog_hash_miss_<%= $host %>-`date +'%m_%d_%y_%R'`.json
  curl -k https://<%= $host %>:8081/metrics/v1/mbeans/puppetlabs.puppetdb.storage%3Aname%3Dcatalog-hash-miss-time --cert /etc/puppetlabs/puppet/ssl/certs/<%= $::clientcert %>.pem --key /etc/puppetlabs/puppet/ssl/private_keys/<%= $::clientcert %>.pem --cacert /etc/puppetlabs/puppet/ssl/certs/ca.pem >> <%= $output_dir %>/catalog_hash_miss_<%= $host %>-`date +'%m_%d_%y_%R'`.json

  echo 'curl -k https://<%= $host %>:8081/metrics/v1/mbeans/puppetlabs.puppetdb.storage%3Aname%3Dcatalog-hash-match-time' --cert /etc/puppetlabs/puppet/ssl/certs/<%= $::clientcert %>.pem --key /etc/puppetlabs/puppet/ssl/private_keys/<%= $::clientcert %>.pem --cacert /etc/puppetlabs/puppet/ssl/certs/ca.pem >> <%= $output_dir %>/catalog_hash_match_<%= $host %>-`date +'%m_%d_%y_%R'`.json
  curl -k https://<%= $host %>:8081/metrics/v1/mbeans/puppetlabs.puppetdb.storage%3Aname%3Dcatalog-hash-match-time --cert /etc/puppetlabs/puppet/ssl/certs/<%= $::clientcert %>.pem --key /etc/puppetlabs/puppet/ssl/private_keys/<%= $::clientcert %>.pem --cacert /etc/puppetlabs/puppet/ssl/certs/ca.pem >> <%= $output_dir %>/catalog_hash_match_<%= $host %>-`date +'%m_%d_%y_%R'`.json

  echo 'curl -k https://<%= $host %>:8081/metrics/v1/mbeans/puppetlabs.puppetdb.storage%3Aname%3Dreplace-catalog-time' --cert /etc/puppetlabs/puppet/ssl/certs/<%= $::clientcert %>.pem --key /etc/puppetlabs/puppet/ssl/private_keys/<%= $::clientcert %>.pem --cacert /etc/puppetlabs/puppet/ssl/certs/ca.pem >> <%= $output_dir %>/replace_catalog_time_<%= $host %>-`date +'%m_%d_%y_%R'`.json
  curl -k https://<%= $host %>:8081/metrics/v1/mbeans/puppetlabs.puppetdb.storage%3Aname%3Dreplace-catalog-time --cert /etc/puppetlabs/puppet/ssl/certs/<%= $::clientcert %>.pem --key /etc/puppetlabs/puppet/ssl/private_keys/<%= $::clientcert %>.pem --cacert /etc/puppetlabs/puppet/ssl/certs/ca.pem >> <%= $output_dir %>/replace_catalog_time_<%= $host %>-`date +'%m_%d_%y_%R'`.json

  echo 'curl -k https://<%= $host %>:8081/metrics/v1/mbeans/puppetlabs.puppetdb.storage%3Aname%3Dreplace-facts-time' --cert /etc/puppetlabs/puppet/ssl/certs/<%= $::clientcert %>.pem --key /etc/puppetlabs/puppet/ssl/private_keys/<%= $::clientcert %>.pem --cacert /etc/puppetlabs/puppet/ssl/certs/ca.pem >> <%= $output_dir %>/replace_facts_time_<%= $host %>-`date +'%m_%d_%y_%R'`.json
  curl -k https://<%= $host %>:8081/metrics/v1/mbeans/puppetlabs.puppetdb.storage%3Aname%3Dreplace-facts-time --cert /etc/puppetlabs/puppet/ssl/certs/<%= $::clientcert %>.pem --key /etc/puppetlabs/puppet/ssl/private_keys/<%= $::clientcert %>.pem --cacert /etc/puppetlabs/puppet/ssl/certs/ca.pem >> <%= $output_dir %>/replace_facts_time_<%= $host %>-`date +'%m_%d_%y_%R'`.json
<% } -%>
